{"createdAt":"2025-02-24T14:28:32.995Z","updatedAt":"2025-02-24T14:31:48.000Z","id":"buWz4s01XuEN3MIY","name":"Stock analysis","active":false,"nodes":[{"parameters":{"content":"## Senior Research Analyst Plans work üí≠\n\n**Plan the work for the team**\n","height":554.958136944418,"width":319.697690939268,"color":7},"id":"99c3c217-259c-47b9-a1ff-426bb2ebe2e8","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[-1800,20],"typeVersion":1},{"parameters":{"assignments":{"assignments":[{"id":"5defb0a2-d921-4909-b10d-da59e1768496","name":"sections","type":"number","value":"=5"},{"id":"230ebd0b-73c2-4265-9b3c-57af7fbc48c8","name":"words","type":"number","value":"=1500"},{"id":"ce289c1f-c20d-4ae5-9192-52f129b704e6","name":"company","type":"string","value":"nvda"},{"id":"bd4c5470-b798-4f7e-8139-a13864742412","name":"webhook_url_sec10k_data","type":"string","value":"https://n8n.aifornoncoders.com/webhook/19f5499a-3083-4783-93a0-e8ed76a9f742"}]},"includeOtherFields":true,"options":{}},"id":"8e605736-ae59-40ed-8e10-69d27026a2cf","name":"Settings","type":"n8n-nodes-base.set","position":[-2080,220],"typeVersion":3.3},{"parameters":{"content":"## Settings ‚ú®\n\n**Start here to configure settings for this workflow**\n\n1. The company to research\n2. The level detail of the report by specifying the number of words and sections","height":555.9314234313579,"width":371.64121982039524,"color":7},"id":"5039cd7c-5339-4798-a0e3-cce334e730cb","name":"Sticky Note8","type":"n8n-nodes-base.stickyNote","position":[-2200,20],"typeVersion":1},{"parameters":{"content":"## Delegates work üßë‚Äçü§ù‚Äçüßë\n\n**Delegate work to team of Researchers**","height":552.8695283216254,"width":326.47038972308576,"color":7},"id":"081e83c5-1a09-4aa3-b360-a559ec6e4607","name":"Sticky Note16","type":"n8n-nodes-base.stickyNote","position":[-1440,20],"typeVersion":1},{"parameters":{"content":"## Researchers at work üó†\n\n**Researchers collaborating based on Senior Researcher plan**\n","height":556.1383800736475,"width":333.40108076977657,"color":7},"id":"627fc34a-fe4c-44dd-bcae-c68da409fe57","name":"Sticky Note19","type":"n8n-nodes-base.stickyNote","position":[-1080,20],"typeVersion":1},{"parameters":{"content":"## Senior Editor ‚úçÔ∏è\n\n**Make writing story of the report high quality**\n","height":555.3391014753818,"width":666.4253447940705,"color":7},"id":"532e39a5-fc8b-479a-81e9-6447fccdd834","name":"Sticky Note21","type":"n8n-nodes-base.stickyNote","position":[-700,20],"typeVersion":1},{"parameters":{},"id":"0cbace78-064c-4be3-89bf-c2ef9dc94463","name":"Wikipedia","type":"@n8n/n8n-nodes-langchain.toolWikipedia","position":[-1600,460],"typeVersion":1},{"parameters":{},"id":"c229744e-39fe-4f02-b07f-20b010e8abfb","name":"Wikipedia1","type":"@n8n/n8n-nodes-langchain.toolWikipedia","position":[-880,460],"typeVersion":1},{"parameters":{},"id":"2e3ee25e-c1ed-45a1-ac60-fe4758d0c37c","name":"When clicking \"Test workflow\"","type":"n8n-nodes-base.manualTrigger","position":[-2380,220],"typeVersion":1},{"parameters":{"name":"sec10_k_nvda","description":"=Use this tool to answer fundamental questions about {{ $json.company }} from SEC 10-K. The input to this tool should be the question to be asked about {{ $json.company }}. For example, what does {{ $json.company }}  do to earn money?","jsCode":"options = {\n\turl: $('Settings').item.json.webhook_url_sec10k_data,\n    method: 'POST',\n    body: {\"input\": query, \"company\": $('Settings').item.json.company}\n}\n      \ntry {\n  const response = await this.helpers.httpRequest(options);\n  console.log(response)\n  return response\n  } catch (error) {\n    return \"error\";\n}"},"id":"c5fb5ac5-7e5f-4b46-9f7b-1e5a9559b0b1","name":"SEC10 Tool","type":"@n8n/n8n-nodes-langchain.toolCode","position":[-1740,460],"typeVersion":1},{"parameters":{"fieldToSplitOut":"message.content.sections","options":{}},"id":"21832b49-94e5-40b9-9118-46057763eeb9","name":"Delegate work","type":"n8n-nodes-base.splitOut","position":[-1340,220],"typeVersion":1},{"parameters":{"mode":"combine","combinationMode":"mergeByPosition","options":{}},"id":"0fe56f8c-58f6-45bd-9264-42d61743a72a","name":"Combine all sections from researchers","type":"n8n-nodes-base.merge","position":[-660,220],"typeVersion":2.1},{"parameters":{"jsCode":"let article = \"\";\n\n// Introduction\narticle += $('Plan work for team').first().json.message.content.introduction;\narticle += \"\\n\\n\";\n\nfor (const item of $input.all()) {\n  article += \"**\" + item.json.title + \"**\";\n  article += \"\\n\";\n  article += item.json.message.content;\n  article += \"\\n\\n\";\n}\n\n// Conclusions\narticle += \"**Conclusions**\";\narticle += \"\\n\\n\";\narticle += $('Plan work for team').first().json.message.content.conclusions;\n\n\nreturn [\n  {\n    \"article\": article\n  }\n];"},"id":"d5d009e1-8273-45e5-9caa-c9a8e0487159","name":"Draft report","type":"n8n-nodes-base.code","position":[-480,220],"typeVersion":1},{"parameters":{"content":"## Publish\n\n**Publish to Google docs.  Update the report name.**","height":557.9049487870623,"width":446,"color":7},"id":"f3e7919f-163c-40c4-852b-388284cc3606","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[0,0],"typeVersion":1},{"parameters":{"name":"sec10_k_nvda","description":"=Use this tool to answer fundamental questions about {{ $('Settings').item.json.company }}\n from SEC 10-K. The input to this tool should be the question to be asked about {{ $('Settings').item.json.company }}. For example, what does {{ $('Settings').item.json.company }}  do to earn money?","jsCode":"options = {\n\turl: $('Settings').item.json.webhook_url_sec10k_data,\n    method: 'POST',\n    body: {\"input\": query, \"company\": $('Settings').item.json.company}\n}\n      \ntry {\n  const response = await this.helpers.httpRequest(options);\n  console.log(response)\n  return response\n  } catch (error) {\n    return \"error\";\n}"},"id":"e5739153-ea51-4170-9e59-0b8e7a88aa4a","name":"SEC10 Tool1","type":"@n8n/n8n-nodes-langchain.toolCode","position":[-1040,460],"typeVersion":1},{"parameters":{"modelId":{"__rl":true,"mode":"list","value":"gpt-3.5-turbo","cachedResultName":"GPT-3.5-TURBO"},"messages":{"values":[{"content":"=You are a details-oriented senior editor known for your insightful and engaging articles.\n\nYour task is to paraphrase the draft report produced by the Research team.  This report is targeted towards the investor community  Please ensure that the report is written in a professional tone and style. Do not leave any important information out from the research team. \n\nHere is the draft report:\n{{ $json.article }} \n"}]},"options":{"maxTokens":4095}},"id":"25f35bbd-dec2-44ef-88c6-66befba9deae","name":"Polish report","type":"@n8n/n8n-nodes-langchain.openAi","position":[-320,220],"typeVersion":1},{"parameters":{"modelId":{"__rl":true,"mode":"list","value":"gpt-4-turbo-preview","cachedResultName":"GPT-4-TURBO-PREVIEW"},"messages":{"values":[{"content":"=You work as a Senior Research Analyst at Goldman Sachs, focusing on fundamental research for tech companies.  You have a team of Research analysts that will help you with various aspects of fundamental stock research.  \n\nYour task is to break down the work of this analysis report:\n- Write the title\n- The subtitle\n- The section details\n- The introduction\n- The conclusions\n- an image prompt for a SEO-friendly article about the company {{ $json.company }}.  \n\nThis analysis report will be a comprehensive analysis of {{ $json.company }} using the latest SEC 10-K filing. The analysis should include the following key sections : Business Overview, Company Strategy, SWOT (Strength, Weakness, Opportunities, Threats), Top 3 Risk Factors, Management's Discussion and Analysis (MD&A), Near term catalysts for growth, and Future Outlook\n\nDetailed Instructions:\n- All information is sourced from {{ $json.company }} latest SEC 10-K filing and that the analysis is unbiased and factual.\n- When necessary, use wikipedia to help with the analysis\n- Place the article title in a JSON field called `title`\n- Place the subtitle in a JSON field called `subtitle`\n- Place the introduction in a JSON field called `introduction`\n- In the introduction introduce the topic that is then explored in depth in the rest of the text\n- The introduction should be around 60 words\n- Place the conclusions in a JSON field called `conclusions`\n- The conclusions should be around 60 words\n- Use the conclusions to sum all said in the article and offer a conclusion to the reader\n- The image prompt will be used to produce a photographic cover image for the article and should depict the topics discussed in the article\n- Place the image prompt in a JSON field called `imagePrompt`\n- There should be {{ $json.words.toString() }} sections.\n- For each section provide a title and an exaustive prompt that your team mates of Researchers can follow that will be used to write the section text.\n- Place the sections in an array field called `sections`\n- For each section provide the fields `title` and `prompt`\n- The section should follow a logical flow and not repeat the same concepts.\n- The section should be one related to the other and not isolated blocks of text. The text should be fluent and folow a linear logic.\n- Don't start the section with \"section 1\", \"section 2\", \"section 3\"... just write the title of the section\n- For the title and the section's titles don't use colons (`:`)\n- For the text, use markdown language for formatting\n- Use the SEC 10K tool for {{ $json.company }} to get information about the company\n- Go deep in the topic you treat, don't just throw some superficial info"}]},"jsonOutput":true,"options":{"maxTokens":2048}},"id":"19e74975-c371-44e0-9576-0aebad3b9c46","name":"Plan work for team","type":"@n8n/n8n-nodes-langchain.openAi","position":[-1780,220],"typeVersion":1},{"parameters":{"modelId":{"__rl":true,"mode":"list","value":"gpt-3.5-turbo","cachedResultName":"GPT-3.5-TURBO"},"messages":{"values":[{"content":"=You are a research analyst in the finance industry who works with a senior research analyst to produce an insight report \n\nYour task it to write a section for the report analyzing  {{ $('Settings').item.json.company }}.  Here is the context for the report that the senior research analyst created:\nOverall report title: {{ $('Plan work for team').item.json.message.content.title }}\nOverall report subtitle:  {{ $('Plan work for team').item.json.message.content.subtitle  }}\n\nUse the prompt the Senior research analyst created and write a section titled {{ $json.title }} using this prompt as starting point : {{ $json.prompt }}.\n\nGuidelines:\n- All information is sourced from {{ $('Settings').item.json.company }} latest SEC 10-K filing and that the analysis is unbiased and factual.\n- Just return the plain text for each section (no JSON structure).\n- Use markdown for formatting.\n- Don't add internal titles or headings.\n- The length of each section should be around {{ Math.round(($('Settings').item.json.words - 120)/ $('Settings').item.json.sections) }} words long\n- Go deep in the topic you treat, don't just throw some superficial info\n{{ $itemIndex > 0 ? \"- The previous section talks about \" + $input.all()[$itemIndex-1].json.title : \"\" }}\n{{ $itemIndex > 0 ? \"- The prompt for the previous section is \" + $input.all()[$itemIndex-1].json.prompt : \"\" }}\n{{ $itemIndex < $input.all().length ? \"- The following section will talk about \" + $input.all()[$itemIndex+1].json.title: \"\" }}\n{{ $itemIndex < $input.all().length ? \"- The prompt for the following section is \" + $input.all()[$itemIndex+1].json.prompt : \"\" }}\n- Consider the previous and following section what writing the text for this section. The text must be coherent with the previous and following sections.\n- This section should not repeat the concepts already exposed in the previous section.\n- This section is a part of a larger report so don't include an introduction or conclusions. This section should merge with the rest of the report.\n"}]},"options":{"maxTokens":2048}},"id":"798326ab-d97c-4f34-b057-a301d8db501e","name":"Do detailed research","type":"@n8n/n8n-nodes-langchain.openAi","position":[-1060,220],"typeVersion":1},{"parameters":{"operation":"toText","sourceProperty":"message.content","options":{}},"id":"1c61b63d-1aca-4190-8fff-d877318b39d4","name":"Convert to File","type":"n8n-nodes-base.convertToFile","typeVersion":1.1,"position":[60,220]},{"parameters":{"name":"report.txt","driveId":{"__rl":true,"mode":"list","value":"My Drive"},"folderId":{"__rl":true,"mode":"list","value":"root","cachedResultName":"/ (Root folder)"},"options":{}},"id":"74e50e95-c9e2-48ed-8531-b953a47f9154","name":"Google Drive","type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[280,220]},{"parameters":{"content":"## I'm a note \n**Double click** to edit me. [Q&A](https://n8n.io/workflows/2183-ai-crew-to-automate-fundamental-stock-analysis-qanda-workflow/)\nUses this vector store \nhttps://qdrant.to/cloud\nDeployment support included\nderekcheungsa@gmail.com\nPresentation\nhttps://cheungy0.gumroad.com/l/rzxxa\nYT video\nhttps://www.youtube.com/watch?v=RPLZUWZuZOM","height":280,"width":400},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-2240,680],"id":"223a40b6-1ebc-4a47-9682-fbd3492b1380","name":"Sticky Note2"}],"connections":{"Settings":{"main":[[{"node":"Plan work for team","type":"main","index":0}]]},"Wikipedia":{"ai_tool":[[{"node":"Plan work for team","type":"ai_tool","index":0}]]},"SEC10 Tool":{"ai_tool":[[{"node":"Plan work for team","type":"ai_tool","index":0}]]},"Wikipedia1":{"ai_tool":[[{"node":"Do detailed research","type":"ai_tool","index":0}]]},"SEC10 Tool1":{"ai_tool":[[{"node":"Do detailed research","type":"ai_tool","index":0}]]},"Draft report":{"main":[[{"node":"Polish report","type":"main","index":0}]]},"Delegate work":{"main":[[{"node":"Combine all sections from researchers","type":"main","index":1},{"node":"Do detailed research","type":"main","index":0}]]},"Polish report":{"main":[[{"node":"Convert to File","type":"main","index":0}]]},"When clicking \"Test workflow\"":{"main":[[{"node":"Settings","type":"main","index":0}]]},"Combine all sections from researchers":{"main":[[{"node":"Draft report","type":"main","index":0}]]},"Plan work for team":{"main":[[{"node":"Delegate work","type":"main","index":0}]]},"Do detailed research":{"main":[[{"node":"Combine all sections from researchers","type":"main","index":0}]]},"Convert to File":{"main":[[{"node":"Google Drive","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"a3c6037c-1fcd-4b50-80e7-2bbf8077877f","triggerCount":0,"tags":[{"createdAt":"2025-02-12T00:06:31.183Z","updatedAt":"2025-02-16T12:09:52.918Z","id":"RAEtntqG5GvQKAMI","name":"AD USO INTERNO"},{"createdAt":"2025-02-11T23:59:41.483Z","updatedAt":"2025-02-14T16:18:26.979Z","id":"dzhL8PxGOvRSKz2J","name":"ANCORA IN TEST"}]}